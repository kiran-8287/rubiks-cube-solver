# Rubik's Cube Solver (React + Vite)

An interactive, browser-based Rubik's Cube solver. Paint the cube net with colors that match your physical cube, validate the configuration, and get an optimal move sequence generated by the Kociemba-based `cubejs` solver running in a Web Worker.

- **Live demo**: https://kiran-8287.github.io/rubiks-cube-solver/
- **Tech**: React 18, Vite, Web Workers, `cubejs`

## Features

- **Interactive cube net input** with a color palette
- **Validation** for complete/consistent cube states
- **Fast solving** via `cubejs` initialized in a Web Worker
- **Step-by-step solution view** with move count
- **Keyboard shortcuts** for power users
- **Dark/light theme** preference persisted to `localStorage`

## Getting Started

### Prerequisites

- Node.js 18+ and npm

### Install

```bash
npm install
```

### Run (development)

```bash
npm run dev
```

The app will start on a local Vite dev server. Open the printed URL in your browser.

### Build (production)

```bash
npm run build
```

### Preview production build

```bash
npm run preview
```

## Usage

1. Select a color from the palette.
2. Click the stickers on the cube net to paint all 54 stickers.
3. Press `Solve` to compute the move sequence.

If the cube is already solved, the app will let you know. If the input is invalid or incomplete, you will see a validation error.

### Keyboard shortcuts

- `w` → select `white`
- `y` → select `yellow`
- `r` → select `red`
- `o` → select `orange`
- `b` → select `blue`
- `g` → select `green`
- `c` → clear the cube
- `s` → validate and solve

## Project Structure

- `src/App.jsx` — main UI and interactions
- `src/hooks/useCubeSolver.js` — solver lifecycle and Web Worker messaging
- `public/cubeWorker.js` — Web Worker that loads `cubejs` and solves
- `src/utils/*` — validation and facelet conversion helpers
- `src/reducers/cubeReducer.js` — state management

## How it works

This section explains the full pipeline from user input to the final solution moves.

### 1) Input model (cube net)

- The UI maintains a cube state object with 6 faces: `U, R, F, D, L, B`.
- Each face has 9 stickers (array of 9 color names): `white, yellow, green, blue, red, orange`.

Example shape:

```js
{
  U: ['white', ... 9 items],
  R: ['red', ... 9 items],
  F: ['green', ... 9 items],
  D: ['yellow', ... 9 items],
  L: ['orange', ... 9 items],
  B: ['blue', ... 9 items]
}
```

State updates are handled by `src/reducers/cubeReducer.js`.

### 2) Validation

Before solving, the app validates the cube using `validateCubeStateComplete(...)` to ensure:

- All 54 stickers are painted.
- Each color appears exactly 9 times.
- Basic constraints for a consistent cube state.

If invalid, an error is shown and solving is aborted.

### 3) Conversion to facelet string

The solver expects a Kociemba facelet string (54 chars) in `U,R,F,D,L,B` face order. Conversion happens in `src/utils/conversion.js`:

- Color → facelet mapping:
  - `white → U`
  - `yellow → D`
  - `green → F`
  - `blue → B`
  - `red → R`
  - `orange → L`

Function used by the app: `cubeStateToFacheletString(cubeState)`.

Example (pseudo):

```js
const faceOrder = ['U','R','F','D','L','B'];
let s = '';
for (const face of faceOrder) for (const sticker of cubeState[face]) s += map[sticker];
// s is the 54-char facelet string
```

### 4) Web Worker lifecycle and messaging

The heavy solver work is offloaded to a Web Worker: `public/cubeWorker.js`.

- On app mount, `useCubeSolver()` creates the worker and sends `{ action: 'INIT' }`.
- The worker loads `cubejs` from CDN and runs `Cube.initSolver()` once to build lookup tables.
- When ready, the worker posts `{ type: 'READY' }`.

Message protocol:

- App → Worker:
  - `{ action: 'INIT' }`
  - `{ action: 'SOLVE', facheletString }`
- Worker → App:
  - `{ type: 'READY' }`
  - `{ type: 'SOLVED', solution, moves, moveCount }`
  - `{ type: 'ERROR', error }`

### 5) Calling the solver (the "formula")

When the user clicks Solve and validation passes:

1. App converts the current state to `facheletString`.
2. App posts to worker: `{ action: 'SOLVE', facheletString }`.
3. In the worker:
   - `const cube = Cube.fromString(facheletString);`
   - `const solution = cube.solve(); // uses Kociemba search via cubejs`
   - `const moves = solution.trim().split(/\s+/);`
4. Worker posts back: `{ type: 'SOLVED', solution, moves, moveCount: moves.length }`.

`cube.solve()` is the key call to the Kociemba-based algorithm implemented by `cubejs`.

### 6) Rendering the solution

- The hook `useCubeSolver()` receives `SOLVED` and exposes `moves` and `solution` to the UI.
- The UI displays the move list and count, and can walk through the sequence step by step.
- If the cube is detected as already solved, the app short-circuits and informs the user.

## Deployment

This project is configured to deploy to GitHub Pages. The Vite base path is set to `/rubiks-cube-solver/` when building.

Common flow:

```bash
# Build and prepare 404 for SPA routing
npm run predeploy

# Publish dist/ to gh-pages
npm run deploy
```

Ensure your repository has Pages enabled and points to the `gh-pages` branch created by the deploy step.

## Troubleshooting

- If you see “Solver not ready”, wait a few seconds for the Web Worker to finish initializing `cubejs` and try again.
- If solving fails, double-check that all 54 stickers are painted and each color appears exactly 9 times.
- If hosting under a subpath, verify the `base` option in `vite.config.js` matches your deployment path.

## Acknowledgements

- [`cubejs`](https://github.com/ldez/cubejs) for the Kociemba-based solver
- React and Vite for a great developer experience

## License

MIT
